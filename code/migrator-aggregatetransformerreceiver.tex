\begin{lstlisting}[language=Java, label=atr, caption={Metoden \emph{addTransformer}, og metoden \emph{aggregateTransformerReceiver}, som kjøres i en separat tråd idet \textbf{Migrator}-konstruktøren kalles.}]
private void addTransformer(AbstractAggregateTransformer t) { this.transformers.put(t.getAppVersion(), t); }

private void aggregateTransformerReceiver() {
    AggregateTransformerLoader loader = new AggregateTransformerLoader();
    while ( this.transformers.size() < 1 ) {
        try {
            Path path = Paths.get( new URI("./classes/" + this.className + ".class"));
            if (Files.exists(path)) {
                byte[] classData = Files.readAllBytes(path);
                Class<?> c = loader.createClass(this.className, classData);
                Constructor cons = c.getConstructor(String.class, String.class);
                AbstractAggregateTransformer tran = (AbstractAggregateTransformer) cons.newInstance( "x", "y" );
                this.addTransformer(tran);
            }
        } catch (Exception e) {
            this.logger.error("An error occurred in AggregateTransformerReceiver ", e);
        }
    }
}
\end{lstlisting}
